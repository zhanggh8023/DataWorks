# DataWarks原理知识
dataworks基础知识介绍+实操培训

- ## DataWorks大数据开发平台架构
![](./image/0.png)
  - ### 数据集成-全域数据汇集
    - 20+种数据源
      - 关系型数据库、大型数据存储、非结构化存储、NoSql数据库等，涵盖了90%以上的常用数据源
    - 支持经典专有、混合等网络环境
      - 集团外或者集团内
      - 阿里云数据库实例或本地部署
      - 公网可访问或不可访问
    - 可视化配置与监控
      - 向导模式
      - shell+DataX
    - 支持多种同步方式
      - 实时或者批量
      - 全量或者增量
      - 同步速度视资源组而定，可横向扩展
  - ### 数据集成-大数据的搬运工（任意数据源、任意格式、任意位置、任意复杂网络环境下的高效数据采集传输）
    - 通过对以下数据抽取转换
      - 关系型数据库
            - SQL Server/PostergreSQL/梦达/DRDS/MYSQL/oracle/rds for ppas/db2
      - MPP
            - HybridDB for Mysql/HybridDB for PostgreSQL
      - 大数据存储
          - Maxcompute/HDFS
      - 非结构化存储
          - OSS/FTP/多媒体文件
      - NoSql
          - HBASE/OTS/MongoDB
    - 可跨公网，实时/离线导入
    ![](./image/1.png)
  - ### 数据研发-DataStudio千万级人物调度能力
      - DataStudio（DataWorks大数据综合数据开发工作室XStudio的核心-DataStudio：支持流批一体、AI、交互式查询和自定义引擎节点等跨赢取混编工作流可视化开发运维环境，可提供妙计可传参条件判断分支循环依赖大规模强保障周期调度能力的大数据综合开发工作平台，包括：大规模调度Alisa,智能运维，统一元数据等）
      - 更友好、更高效、更智能的IDE
          - 产品交互升级，全新炫酷皮肤，更易用
          - 编辑器SQL输入智能提示，代码格式化和折叠
          - SQL结构可视化展示和定位
      - 拖拽式可视化DAG开发模式
          - 基于DAG模式，提供可视化组件拖拽式流计算
          - 任务“零代码”开发
      - 新增循环判断控制节点
      - 实时转实例，无需再等T+1生效
      - 新增自定义节点
    ![](./image/2.png)
  - ### 数据治理-常见问题
      - 数据信息分散
            - 业务系统不清晰，数据资产不明晰
      - 元数据不全
            - 需要有业务接口人，能维护补全业务信息
      - 数据质量差
            - 上传来的是一张空表，或者无效字段，总靠人肉来判别
      - 维护困难
            - 数据有问题，总是事后才知道，该由谁去维护预防
      - 审计信息
            - 用数据的人那么多，如何保障数据访问是可靠安全的
    ![](./image/3.png)
  - ### 百万任务、千万表 应该如何管理？
      - 痛点：
    ![](./image/4.png)
      - 智能监控能力升级
        - 智能识别关键路径，合理设定报警阀值
        - 任务异常产生事件，自动评估事件影响范围，通知相应人员
        - 灵活报警方式配置，支持钉钉群机器人
      - 运维中心：智能监控
  - ### 数据质量-DQC
    - 数据质量，属于数仓中最常见问题，在整个流程中随时可能发生，严重影响数仓落地。
    - 解决数据质量问题，除了依托工具，还需要从管理整个体系做支撑，能够责任落实到人，完善监督发现机制。
    - 依托DataWorks数据质量监控，全程监控数据加工流水线，根据质量规则及时发现问题，通过强弱报警通知开发同学及时处理问题。
    ![](./image/5.png)

  - ### 数据治理-数据保护伞
    ![](./image/6.png)
  - ### 数据服务
    - DataWorks数据云上托管服务中心-数据服务：支持弹性伸缩的，高稳定QPS的，多数据源多协议的，Serverless服务编排的，云上数据托管API服务平台，包括：可视化生成API，自定义SQL生成API，函数计算，服务编排等，致力于数据服务化，数据共享和开放。
    ![](./image/7.png) 


- ## DataWorks实战安排
  场景：海量日志分析
  - 数据集成、数据开发、数据分析、运维中心、数据质量、数据服务、数据服务 

  - 开通地址:https://data.aliyun.com/product/ide?spm=5176.10695662.881989.1.52434695XIl4Yx
  - ### 开通过程：  
    - #### 目前按量付费，开通不需要付费，基础版免费
  ![](./image/8.png)
  ![](./image/9.png)
  ![](./image/10.png)
    - #### 需要选工作空间的计算引擎服务，仍然需要开发按量付费功能，开通免费；然后勾选该服务进行下一步。
  ![](./image/11.png)
    - #### 需要填写实例显示名称，创建实例
  ![](./image/12.png)
    - #### 稍等片刻成功后，点击进入数据开发
  ![](./image/13.png)

  - ### 业务实战
    - #### 进入开发控制台后，新建业务流程：海量日志分析
  ![](./image/14.png) 
  ![](./image/15.png) 
  ![](./image/16.png) 
    - #### 操作界面，在通用菜单找到-虚拟节点，拖动到画布，新建开始节点
  ![](./image/17.png) 
  ![](./image/18.png) 
    - #### 在数据集成中拖入两个-离线同步组件，分别命名为oss日志数据同步、rds用户数据同步
  ![](./image/19.png) 
  ![](./image/20.png) 
  ![](./image/21.png) 
    - #### 对-开始组件连接-离线同步组件，双击-开始进入后选择调度配置
  ![](./image/22.png) 
  ![](./image/23.png) 
    - #### 修改发布后生效，并使用工作空间根节点，点击保存
  ![](./image/24.png) 
    - #### 返回主界面，点击进入数据集成页面
  ![](./image/25.png) 
  ![](./image/26.png)
    - #### 点击数据源管理，新增数据源
  ![](./image/27.png)
    - #### 新增半结构化下的oss数据源，并测试联通
    - #### 详情参看：https://help.aliyun.com/document_detail/146754.html?spm=5176.11065259.1996646101.searchclickresult.62e15ebapVxaKt
  ![](./image/28.png)
  ![](./image/29.png)
    - #### 同理完成MySql的新建
  ![](./image/30.png)
    - #### 返回主界面，双击进入日志数据，根据步骤填入数据源（具体填写参考help详情链接）、字段映射、通道控制
  ![](./image/31.png)
    - #### 在数据去向中选择ODPS,根据文档中方法创建两张表
  ![](./image/32.png)
    - #### 新建表
        - 在数据开发页面打开新建的业务流程，右键单击MaxCompute，选择新建 > 表。在新建表对话框中，输入表名，单击提交。此处需要创建2张表（ods_raw_log_d和ods_user_info_d），分别存储同步过来的OSS日志数据和RDS日志数据。

      - 通过DDL模式新建表。
      新建ods_raw_log_d表。
      双击ods_raw_log_d表，在右侧的编辑页面单击DDL模式，输入下述建表语句。
  ![](./image/33.png)
    ```sql
      --创建OSS日志对应目标表
      CREATE TABLE IF NOT EXISTS  ods_raw_log_d (
          col STRING
      )
      PARTITIONED BY (
          dt STRING
      );
    ```
    - #### 新建ods_user_info_d表。 双击ods_user_info_d表，在右侧的编辑页面单击DDL模式，输入下述建表语句。
    ```sql
      --创建RDS对应目标表
      CREATE TABLE IF NOT  EXISTS ods_user_info_d (
          uid STRING COMMENT '用户ID',
          gender STRING COMMENT '性别',
          age_range STRING COMMENT '年龄段',
          zodiac STRING COMMENT '星座'
      )
      PARTITIONED BY (
          dt STRING
      );
    ```
    - #### 建表语句输入完成后，单击生成表结构并确认覆盖当前操作。返回建表页面后，在基本属性中输入表的中文名。完成设置后，分别单击提交到开发环境和提交到生产环境。
  
  
  ![](./image/25.png)
  ![](./image/25.png)

